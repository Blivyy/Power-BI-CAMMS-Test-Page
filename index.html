<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <title>MAG Assurance Command Centre – Prototype</title>
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />

  <!-- Chart.js CDN -->
  <script src="https://cdn.jsdelivr.net/npm/chart.js@4.4.0/dist/chart.umd.min.js"></script>

  <style>
    /* ---------- GLOBAL ---------- */
    * {
      box-sizing: border-box;
      margin: 0;
      padding: 0;
      font-family: system-ui, -apple-system, BlinkMacSystemFont, "Segoe UI", sans-serif;
    }

    body {
      min-height: 100vh;
      background: radial-gradient(circle at top, #1b2540 0, #040817 35%, #02040c 100%);
      color: #e5ecff;
      display: flex;
      justify-content: center;
      align-items: flex-start;
      padding: 24px;
    }

    .shell {
      width: 100%;
      max-width: 1600px;
      border-radius: 22px;
      padding: 20px 24px 26px;
      background: linear-gradient(145deg, #050816, #02030b);
      box-shadow: 0 26px 80px rgba(0,0,0,0.65);
      border: 1px solid rgba(120,160,255,0.25);
    }

    h1 {
      font-size: 30px;
      letter-spacing: 0.04em;
      margin-bottom: 4px;
    }

    .subtitle {
      font-size: 13px;
      color: #9ca9d9;
      margin-bottom: 18px;
    }

    /* ---------- TOP BAR: NAV + FILTERS ---------- */

    .top-bar {
      display: flex;
      flex-direction: column;
      gap: 14px;
      width: 100%;
      margin-bottom: 18px;
    }

    .nav-row {
      display: flex;
      flex-wrap: wrap;
      gap: 10px;
      justify-content: flex-start;
    }

    .nav-button {
      border: none;
      padding: 7px 22px;
      border-radius: 999px;
      font-size: 13px;
      cursor: pointer;
      background: #0b1220;
      color: #e5ecff;
      box-shadow: inset 0 0 0 1px rgba(68,90,150,0.7);
      transition: background 0.18s ease, box-shadow 0.18s ease, transform 0.12s ease;
    }

    .nav-button.active {
      background: linear-gradient(90deg, #ff8a4a, #ff3c7e);
      box-shadow: 0 0 14px rgba(255,88,140,0.85);
      color: #fff;
      transform: translateY(-1px);
    }

    .nav-button:hover:not(.active) {
      background: #111827;
      box-shadow: inset 0 0 0 1px rgba(113,161,255,0.9);
    }

    .filter-row {
      display: flex;
      flex-wrap: wrap;
      gap: 10px;
    }

    .filter-pill {
      flex: 1 1 180px;
      min-width: 0;
      display: flex;
      align-items: center;
      justify-content: space-between;
      padding: 6px 12px 6px 14px;
      border-radius: 18px;
      background: radial-gradient(circle at top left, #111827 0, #050814 70%);
      box-shadow: 0 0 0 1px rgba(58,85,150,0.75),
                  0 10px 30px rgba(0,0,0,0.75);
      font-size: 12px;
      color: #cdd6ff;
      gap: 8px;
    }

    .filter-pill label {
      font-size: 11px;
      text-transform: uppercase;
      letter-spacing: 0.08em;
      color: #7f8bb5;
    }

    .filter-pill select {
      flex: 1;
      margin-left: 4px;
      background: transparent;
      border: none;
      color: #e5ecff;
      font-size: 12px;
      outline: none;
    }

    .filter-pill option {
      color: #050816;
    }

    /* ---------- PAGE CONTAINER ---------- */

    .page {
      display: none;
    }
    .page-active {
      display: block;
    }

    /* ---------- GRID LAYOUTS ---------- */

    .two-column {
      display: grid;
      grid-template-columns: 1.1fr 1.1fr;
      gap: 18px;
    }

    .kpi-row {
      display: grid;
      grid-template-columns: repeat(3, minmax(0, 1fr));
      gap: 14px;
      margin-bottom: 18px;
    }

    @media (max-width: 1100px) {
      .two-column {
        grid-template-columns: 1fr;
      }
      .kpi-row {
        grid-template-columns: 1fr;
      }
    }

    /* ---------- CARDS / PANELS ---------- */

    .panel {
      background: radial-gradient(circle at top left, #111827 0, #050816 55%, #02040d 100%);
      border-radius: 20px;
      padding: 14px 16px 16px;
      box-shadow:
        0 0 0 1px rgba(77, 117, 190, 0.55),
        0 18px 40px rgba(0,0,0,0.8);
      position: relative;
      overflow: hidden;
    }

    .panel-header {
      display: flex;
      justify-content: space-between;
      align-items: baseline;
      margin-bottom: 6px;
    }

    .panel-title {
      font-size: 13px;
      text-transform: uppercase;
      letter-spacing: 0.13em;
      color: #aab4e0;
    }

    .panel-subtitle {
      font-size: 11px;
      color: #808bb7;
    }

    /* KPI cards */

    .kpi-card {
      background: radial-gradient(circle at top left, #151b30 0, #050816 55%);
      border-radius: 18px;
      padding: 10px 14px 12px;
      box-shadow:
        0 0 0 1px rgba(101, 132, 210, 0.8),
        0 0 18px rgba(12, 195, 255, 0.22);
      display: flex;
      flex-direction: column;
      gap: 2px;
    }

    .kpi-label {
      font-size: 11px;
      text-transform: uppercase;
      letter-spacing: 0.12em;
      color: #9ca9d9;
    }

    .kpi-value {
      font-size: 26px;
      font-weight: 600;
      margin-top: 4px;
    }

    .kpi-footnote {
      font-size: 11px;
      color: #7c86b7;
    }

    /* Play area */

    .play-panel {
      margin-top: 8px;
      display: grid;
      grid-template-columns: 1.1fr 1.1fr;
      gap: 12px;
      align-items: center;
    }

    @media (max-width: 900px) {
      .play-panel {
        grid-template-columns: 1fr;
      }
    }

    .play-inputs {
      display: grid;
      grid-template-columns: 1fr 1fr;
      gap: 10px;
      font-size: 12px;
    }

    .play-inputs label {
      display: flex;
      flex-direction: column;
      gap: 4px;
      font-size: 11px;
      color: #aab4e0;
    }

    .play-inputs input {
      padding: 6px 8px;
      border-radius: 8px;
      border: 1px solid rgba(88,120,210,0.8);
      background: #020510;
      color: #f5f7ff;
      outline: none;
    }

    .play-button {
      margin-top: 4px;
      padding: 7px 14px;
      border-radius: 999px;
      border: none;
      font-size: 12px;
      cursor: pointer;
      align-self: flex-start;
      background: linear-gradient(90deg, #ff8a4a, #ff3c7e);
      color: #fff;
      box-shadow: 0 0 12px rgba(255,97,145,0.9);
      transition: transform 0.12s ease, box-shadow 0.12s ease;
    }

    .play-button:hover {
      transform: translateY(-1px);
      box-shadow: 0 0 16px rgba(255,105,155,1);
    }

    .play-note {
      font-size: 11px;
      color: #7f8ab8;
      margin-top: 4px;
    }

    .tiny-footnote {
      margin-top: 10px;
      font-size: 10px;
      color: #6f7aa8;
      text-align: right;
    }

    canvas {
      width: 100% !important;
      height: 220px !important;
    }

    /* ---------- LEGEND BAR ---------- */

    .legend-bar {
      display: flex;
      gap: 18px;
      font-size: 11px;
      margin-top: 8px;
      color: #9ca9d9;
    }

    .legend-dot {
      width: 10px;
      height: 10px;
      border-radius: 999px;
      margin-right: 5px;
      display: inline-block;
    }

    .dot-green { background: #22c55e; }
    .dot-amber { background: #eab308; }
    .dot-red   { background: #fb4b63; }

    /* ---------- PLACEHOLDER TEXT BLOCKS ---------- */

    .placeholder {
      font-size: 13px;
      color: #9ca9d9;
      line-height: 1.5;
    }

    .placeholder strong {
      color: #f9fafb;
    }

    .placeholder-list {
      margin-top: 8px;
      padding-left: 18px;
    }

    .placeholder-list li {
      margin-bottom: 4px;
    }

    /* ---------- SIMPLE TABLE (CAMMS) ---------- */

    table {
      width: 100%;
      border-collapse: collapse;
      margin-top: 10px;
      font-size: 11px;
    }

    th, td {
      padding: 6px 8px;
      text-align: left;
    }

    th {
      text-transform: uppercase;
      letter-spacing: 0.08em;
      color: #aab4e0;
      border-bottom: 1px solid rgba(148, 163, 210, 0.4);
    }

    tbody tr:nth-child(even) {
      background: rgba(15,23,42,0.7);
    }

    td {
      color: #d1d5f0;
    }
  </style>
</head>
<body>
  <div class="shell">
    <h1>MAG Assurance Command Centre</h1>
    <div class="subtitle">
      Unified view of tracker-based actions and CAMMS enterprise risk data (prototype mock)
    </div>

    <!-- TOP: NAV + FILTERS -->
    <div class="top-bar">
      <div class="nav-row">
        <button class="nav-button active" data-page="overview">Overview</button>
        <button class="nav-button" data-page="airport">Airport Detail</button>
        <button class="nav-button" data-page="trends">Trends</button>
        <button class="nav-button" data-page="tracker">Tracker View</button>
        <button class="nav-button" data-page="camms">CAMMS View</button>
        <button class="nav-button" data-page="combined">Combined</button>
      </div>

      <div class="filter-row">
        <div class="filter-pill">
          <div>
            <label>Airport</label>
            <select>
              <option>All (MAN · EMA · STN · CAVU)</option>
              <option>MAN</option>
              <option>EMA</option>
              <option>STN</option>
              <option>CAVU</option>
            </select>
          </div>
        </div>

        <div class="filter-pill">
          <div>
            <label>Department</label>
            <select>
              <option>All Functions</option>
              <option>Operations</option>
              <option>Security</option>
              <option>Environment</option>
            </select>
          </div>
        </div>

        <div class="filter-pill">
          <div>
            <label>Date range</label>
            <select>
              <option>FY26 · Q1–Q2</option>
              <option>FY26 · Q3–Q4</option>
              <option>FY25 · Full Year</option>
            </select>
          </div>
        </div>

        <div class="filter-pill">
          <div>
            <label>Action status</label>
            <select>
              <option>All (Open · In Progress · Paused · Closed)</option>
              <option>Open</option>
              <option>In Progress</option>
              <option>Paused</option>
              <option>Closed</option>
            </select>
          </div>
        </div>

        <div class="filter-pill">
          <div>
            <label>Risk tier</label>
            <select>
              <option>Critical · High · Medium</option>
              <option>Critical only</option>
              <option>High only</option>
              <option>Medium only</option>
            </select>
          </div>
        </div>
      </div>
    </div>

    <!-- ================= OVERVIEW PAGE ================= -->
    <section id="overview" class="page page-active">
      <div class="two-column">
        <!-- Left: Operational trackers -->
        <div class="panel">
          <div class="panel-header">
            <div class="panel-title">Operational Trackers</div>
            <div class="panel-subtitle">Excel + SharePoint (mocked)</div>
          </div>

          <!-- KPI row -->
          <div class="kpi-row">
            <div class="kpi-card">
              <div class="kpi-label">Overdue actions</div>
              <div class="kpi-value" id="kpi-overdue">14</div>
              <div class="kpi-footnote">Across all airports – last 90 days</div>
            </div>
            <div class="kpi-card">
              <div class="kpi-label">Completion rate</div>
              <div class="kpi-value" id="kpi-completion">89%</div>
              <div class="kpi-footnote">On-time closure vs target SLA</div>
            </div>
            <div class="kpi-card">
              <div class="kpi-label">Avg. days open</div>
              <div class="kpi-value" id="kpi-days-open">12</div>
              <div class="kpi-footnote">Median age of live actions</div>
            </div>
          </div>

          <!-- Charts -->
          <div class="kpi-row">
            <div class="panel" style="padding:10px 12px 12px;">
              <div class="panel-header">
                <span class="panel-title">Manual review trend</span>
              </div>
              <canvas id="trendChart"></canvas>
            </div>
            <div class="panel" style="padding:10px 12px 12px;">
              <div class="panel-header">
                <span class="panel-title">Action age breakdown</span>
              </div>
              <canvas id="ageChart"></canvas>
            </div>
          </div>

          <div class="legend-bar">
            <span><span class="legend-dot dot-green"></span>On target</span>
            <span><span class="legend-dot dot-amber"></span>Watch list</span>
            <span><span class="legend-dot dot-red"></span>Breach / overdue</span>
          </div>
        </div>

        <!-- Right: CAMMS + play with data -->
        <div class="panel">
          <div class="panel-header">
            <div>
              <div class="panel-title">Enterprise Assurance (CAMMS)</div>
              <div class="panel-subtitle">Conceptual CAMMS layout – overview slice</div>
            </div>
          </div>

          <div class="kpi-row">
            <div class="kpi-card">
              <div class="kpi-label">Critical risks</div>
              <div class="kpi-value" id="kpi-critical">3</div>
              <div class="kpi-footnote">Above risk appetite threshold</div>
            </div>
            <div class="kpi-card">
              <div class="kpi-label">Controls tested</div>
              <div class="kpi-value" id="kpi-controls">72</div>
              <div class="kpi-footnote">Includes assurance &amp; audit activity</div>
            </div>
            <div class="kpi-card">
              <div class="kpi-label">Policy adherence</div>
              <div class="kpi-value" id="kpi-policy">94%</div>
              <div class="kpi-footnote">Weighted by risk tier</div>
            </div>
          </div>

          <div class="kpi-row">
            <div class="panel" style="padding:10px 12px 12px;">
              <div class="panel-header">
                <span class="panel-title">Risk heatmap (mock)</span>
              </div>
              <canvas id="riskChart"></canvas>
            </div>
            <!-- Play with the data panel -->
            <div class="panel" style="padding:10px 12px 12px;">
              <div class="panel-header">
                <span class="panel-title">Play with the data</span>
              </div>
              <div class="play-panel">
                <div class="play-inputs">
                  <label>
                    Overdue actions
                    <input type="number" id="input-overdue" value="14" min="0" />
                  </label>
                  <label>
                    Completion %
                    <input type="number" id="input-completion" value="89" min="0" max="100" />
                  </label>
                </div>
                <div>
                  <button class="play-button" id="play-button">
                    Update mock metrics
                  </button>
                  <div class="play-note">
                    Adjust the numbers to see KPI tiles and charts react.  
                    (Purely illustrative – no real MAG data.)
                  </div>
                </div>
              </div>
              <div class="tiny-footnote">
                Prototype only – in Power BI this behaviour would be driven by real measures &amp; bookmarks.
              </div>
            </div>
          </div>
        </div>
      </div>
    </section>

    <!-- ================= AIRPORT DETAIL PAGE ================= -->
    <section id="airport" class="page">
      <div class="panel">
        <div class="panel-header">
          <div class="panel-title">Airport Detail – Concept</div>
          <div class="panel-subtitle">Drill-through from overview by airport selection</div>
        </div>
        <div class="placeholder">
          <p>
            This page would show a <strong>drill-through view</strong> for the selected airport (e.g. STN),
            combining tracker and CAMMS detail.
          </p>
          <ul class="placeholder-list">
            <li>Left column – timeline of open vs closed actions, owners, overdue list.</li>
            <li>Right column – CAMMS risk register for that airport with controls &amp; coverage.</li>
            <li>Sticky header with airport KPIs + breadcrumb back to Overview.</li>
          </ul>
        </div>
      </div>
    </section>

    <!-- ================= TRENDS PAGE ================= -->
    <section id="trends" class="page">
      <div class="panel">
        <div class="panel-header">
          <div class="panel-title">Trends & Forward Look – Concept</div>
          <div class="panel-subtitle">Long-term view across FYs</div>
        </div>
        <div class="placeholder">
          <p>
            Use this view for <strong>RAB / SRB style discussions</strong>, showing:
          </p>
          <ul class="placeholder-list">
            <li>Combined tracker + CAMMS trend of overall risk exposure vs assurance coverage.</li>
            <li>Recurring themes by root cause / directorate / process family.</li>
            <li>A forward-look panel summarising planned assurance and open high risks.</li>
          </ul>
        </div>
      </div>
    </section>

    <!-- ================= TRACKER VIEW PAGE ================= -->
    <section id="tracker" class="page">
      <div class="panel">
        <div class="panel-header">
          <div class="panel-title">Tracker View – Concept</div>
          <div class="panel-subtitle">Excel / SharePoint-derived action view</div>
        </div>
        <div class="placeholder">
          <p>
            This page would mirror your existing <strong>assurance action tracker</strong> in a simplified grid:
          </p>
          <ul class="placeholder-list">
            <li>Columns: ID, Theme, Lead, Airport, Status, Due date, Age.</li>
            <li>Toggle between <em>all actions</em> and <em>only overdue / at risk</em>.</li>
            <li>Quick filters for Leads, Themes and Quarter.</li>
          </ul>
        </div>
      </div>
    </section>

    <!-- ================= CAMMS VIEW PAGE ================= -->
    <section id="camms" class="page">
      <div class="two-column">
        <!-- Left: CAMMS KPIs + heatmap -->
        <div class="panel">
          <div class="panel-header">
            <div class="panel-title">CAMMS – Enterprise Assurance View</div>
            <div class="panel-subtitle">Risk register + heatmap + coverage</div>
          </div>

          <div class="kpi-row">
            <div class="kpi-card">
              <div class="kpi-label">Total open risks</div>
              <div class="kpi-value">128</div>
              <div class="kpi-footnote">All airports – filtered by slicers above</div>
            </div>
            <div class="kpi-card">
              <div class="kpi-label">Critical / very high</div>
              <div class="kpi-value">11</div>
              <div class="kpi-footnote">Breaching risk appetite statement</div>
            </div>
            <div class="kpi-card">
              <div class="kpi-label">Assurance coverage</div>
              <div class="kpi-value">78%</div>
              <div class="kpi-footnote">Completed vs planned engagements</div>
            </div>
          </div>

          <div class="panel" style="padding:10px 12px 12px; margin-top:8px;">
            <div class="panel-header">
              <span class="panel-title">Risk heatmap (inherent vs residual)</span>
            </div>
            <canvas id="cammsHeatmapChart"></canvas>
          </div>
        </div>

        <!-- Right: Coverage + sample risk register -->
        <div class="panel">
          <div class="panel-header">
            <div class="panel-title">Assurance Plan vs Completed</div>
            <div class="panel-subtitle">Sample layout for CAMMS-linked assurance activity</div>
          </div>
          <div class="panel" style="padding:10px 12px 12px;">
            <canvas id="cammsCoverageChart"></canvas>
          </div>

          <div class="panel-subtitle" style="margin-top:10px;">Sample risk register (drill-through in real build)</div>
          <table>
            <thead>
              <tr>
                <th>ID</th>
                <th>Airport</th>
                <th>Category</th>
                <th>Risk</th>
                <th>Tier</th>
                <th>Owner</th>
                <th>Status</th>
              </tr>
            </thead>
            <tbody>
              <tr>
                <td>R-0113</td>
                <td>MAN</td>
                <td>Security</td>
                <td>Screening capacity shortfall</td>
                <td>High</td>
                <td>Head of Security</td>
                <td>Mitigations in progress</td>
              </tr>
              <tr>
                <td>R-0147</td>
                <td>STN</td>
                <td>Resilience</td>
                <td>Loss of primary power to terminal</td>
                <td>Very High</td>
                <td>Resilience Lead</td>
                <td>Contingency plan under test</td>
              </tr>
              <tr>
                <td>R-0205</td>
                <td>EMA</td>
                <td>Operations</td>
                <td>Staffing gaps on late shifts</td>
                <td>Medium</td>
                <td>Ops Duty Manager</td>
                <td>Actions assigned</td>
              </tr>
              <tr>
                <td>R-0251</td>
                <td>CAVU</td>
                <td>IT &amp; Digital</td>
                <td>Minor reporting latency</td>
                <td>Low</td>
                <td>BI Product Owner</td>
                <td>Accepted</td>
              </tr>
            </tbody>
          </table>
        </div>
      </div>
    </section>

    <!-- ================= COMBINED PAGE ================= -->
    <section id="combined" class="page">
      <div class="two-column">
        <!-- Left: Tracker summary -->
        <div class="panel">
          <div class="panel-header">
            <div class="panel-title">Combined View – Tracker Summary</div>
            <div class="panel-subtitle">Actions across MAN · EMA · STN</div>
          </div>

          <div class="kpi-row">
            <div class="kpi-card">
              <div class="kpi-label">Open actions</div>
              <div class="kpi-value">56</div>
              <div class="kpi-footnote">All airports, all themes</div>
            </div>
            <div class="kpi-card">
              <div class="kpi-label">On track</div>
              <div class="kpi-value">64%</div>
              <div class="kpi-footnote">Within agreed timeframe</div>
            </div>
            <div class="kpi-card">
              <div class="kpi-label">Overdue / at risk</div>
              <div class="kpi-value">36%</div>
              <div class="kpi-footnote">Watch list + breach</div>
            </div>
          </div>

          <div class="panel" style="padding:10px 12px 12px;">
            <div class="panel-header">
              <span class="panel-title">Unified action status</span>
            </div>
            <canvas id="combinedActionsChart"></canvas>
          </div>
        </div>

        <!-- Right: CAMMS summary -->
        <div class="panel">
          <div class="panel-header">
            <div class="panel-title">Combined View – Risk Summary</div>
            <div class="panel-subtitle">CAMMS + trackers side-by-side</div>
          </div>

          <div class="kpi-row">
            <div class="kpi-card">
              <div class="kpi-label">Critical risks</div>
              <div class="kpi-value">3</div>
              <div class="kpi-footnote">Above risk appetite threshold</div>
            </div>
            <div class="kpi-card">
              <div class="kpi-label">High / medium</div>
              <div class="kpi-value">41</div>
              <div class="kpi-footnote">Requires monitoring</div>
            </div>
            <div class="kpi-card">
              <div class="kpi-label">Planned assurance</div>
              <div class="kpi-value">64</div>
              <div class="kpi-footnote">Engagements this FY</div>
            </div>
          </div>

          <div class="panel" style="padding:10px 12px 12px;">
            <div class="panel-header">
              <span class="panel-title">Risk vs assurance coverage</span>
            </div>
            <canvas id="combinedRiskChart"></canvas>
          </div>
        </div>
      </div>
    </section>
  </div>

  <!-- ================= SCRIPT ================= -->
  <script>
    // ----------- NAVIGATION -----------
    const navButtons = document.querySelectorAll('.nav-button');
    const pages = document.querySelectorAll('.page');

    navButtons.forEach(btn => {
      btn.addEventListener('click', () => {
        const pageId = btn.dataset.page;

        navButtons.forEach(b => b.classList.remove('active'));
        btn.classList.add('active');

        pages.forEach(p => {
          if (p.id === pageId) {
            p.classList.add('page-active');
          } else {
            p.classList.remove('page-active');
          }
        });
      });
    });

    // ----------- COLOURS FOR CHARTS -----------
    const chartColors = {
      teal: '#22c5f5',
      green: '#22c55e',
      amber: '#eab308',
      pink: '#fb4b63',
      purple: '#a855f7',
      axis: '#64729b'
    };

    // ----------- OVERVIEW CHARTS -----------

    // trendChart – manual review
    const trendCtx = document.getElementById('trendChart');
    const trendChart = new Chart(trendCtx, {
      type: 'line',
      data: {
        labels: ['Apr', 'May', 'Jun', 'Jul', 'Aug', 'Sep'],
        datasets: [{
          label: 'Manual reviews',
          data: [18, 21, 19, 15, 14, 13],
          borderColor: chartColors.teal,
          backgroundColor: 'rgba(34,197,246,0.08)',
          tension: 0.35,
          fill: true,
          pointRadius: 3,
          pointBackgroundColor: chartColors.teal
        }]
      },
      options: {
        responsive: true,
        maintainAspectRatio: false,
        plugins: {
          legend: { display: false }
        },
        scales: {
          x: { ticks: { color: chartColors.axis }, grid: { display:false } },
          y: { ticks: { color: chartColors.axis }, grid: { color:'rgba(55,65,81,0.45)' } }
        }
      }
    });

    // ageChart – action age breakdown
    const ageCtx = document.getElementById('ageChart');
    const ageChart = new Chart(ageCtx, {
      type: 'bar',
      data: {
        labels: ['0–7d', '8–14d', '15–30d', '31–60d', '60d+'],
        datasets: [{
          label: 'Actions',
          data: [11, 8, 6, 4, 3],
          backgroundColor: [
            chartColors.green,
            chartColors.teal,
            chartColors.amber,
            chartColors.pink,
            chartColors.purple
          ]
        }]
      },
      options: {
        responsive: true,
        maintainAspectRatio: false,
        plugins: { legend: { display: false }},
        scales: {
          x: { ticks: { color: chartColors.axis }, grid: { display:false } },
          y: { ticks: { color: chartColors.axis }, grid: { color:'rgba(55,65,81,0.45)' } }
        }
      }
    });

    // riskChart – CAMMS mock
    const riskCtx = document.getElementById('riskChart');
    const riskChart = new Chart(riskCtx, {
      type: 'bar',
      data: {
        labels: ['Security', 'Ops', 'Engineering', 'Commercial'],
        datasets: [{
          label: 'Open risks',
          data: [8, 6, 4, 5],
          backgroundColor: [chartColors.pink, chartColors.amber, chartColors.teal, chartColors.green]
        }]
      },
      options: {
        responsive: true,
        maintainAspectRatio: false,
        plugins: { legend: { display: false }},
        scales: {
          x: { ticks: { color: chartColors.axis }, grid: { display:false } },
          y: { ticks: { color: chartColors.axis }, grid: { color:'rgba(55,65,81,0.45)' } }
        }
      }
    });

    // ----------- PLAY WITH DATA (OVERVIEW) -----------

    const inputOverdue = document.getElementById('input-overdue');
    const inputCompletion = document.getElementById('input-completion');
    const playButton = document.getElementById('play-button');

    const kpiOverdue = document.getElementById('kpi-overdue');
    const kpiCompletion = document.getElementById('kpi-completion');

    playButton.addEventListener('click', () => {
      const newOverdue = Number(inputOverdue.value) || 0;
      let newCompletion = Number(inputCompletion.value) || 0;
      if (newCompletion < 0) newCompletion = 0;
      if (newCompletion > 100) newCompletion = 100;

      // Update KPI tiles
      kpiOverdue.textContent = newOverdue;
      kpiCompletion.textContent = `${newCompletion}%`;

      // Update charts to react loosely to the new inputs
      const scaleFactor = Math.max(0.3, 1 - newCompletion / 150);
      trendChart.data.datasets[0].data = [18, 21, 19, 15, 14, 10 + Math.round(newOverdue * 0.25 * scaleFactor)];
      trendChart.update();

      ageChart.data.datasets[0].data = [
        Math.round(newOverdue * 0.30),
        Math.round(newOverdue * 0.25),
        Math.round(newOverdue * 0.20),
        Math.round(newOverdue * 0.15),
        Math.max(0, newOverdue - Math.round(newOverdue * 0.90))
      ];
      ageChart.update();
    });

    // ----------- CAMMS PAGE CHARTS -----------

    const cammsHeatCtx = document.getElementById('cammsHeatmapChart');
    const cammsHeatmapChart = new Chart(cammsHeatCtx, {
      type: 'bar',
      data: {
        labels: ['Critical', 'High', 'Medium', 'Low'],
        datasets: [
          {
            label: 'Inherent',
            data: [11, 34, 48, 35],
            backgroundColor: 'rgba(248, 113, 113, 0.8)'
          },
          {
            label: 'Residual',
            data: [5, 24, 40, 32],
            backgroundColor: 'rgba(56, 189, 248, 0.9)'
          }
        ]
      },
      options: {
        responsive: true,
        maintainAspectRatio: false,
        plugins: {
          legend: {
            labels: { color: chartColors.axis, font: { size: 11 } }
          }
        },
        scales: {
          x: { ticks: { color: chartColors.axis }, grid: { display:false } },
          y: { ticks: { color: chartColors.axis }, grid: { color:'rgba(55,65,81,0.45)' } }
        }
      }
    });

    const cammsCovCtx = document.getElementById('cammsCoverageChart');
    const cammsCoverageChart = new Chart(cammsCovCtx, {
      type: 'bar',
      data: {
        labels: ['Planned', 'Completed'],
        datasets: [{
          label: 'Engagements',
          data: [64, 50],
          backgroundColor: [chartColors.teal, chartColors.green]
        }]
      },
      options: {
        responsive: true,
        maintainAspectRatio: false,
        plugins: {
          legend: { display: false }
        },
        scales: {
          x: { ticks: { color: chartColors.axis }, grid: { display:false } },
          y: { ticks: { color: chartColors.axis }, grid: { color:'rgba(55,65,81,0.45)' } }
        }
      }
    });

    // ----------- COMBINED PAGE CHARTS -----------

    const combActionsCtx = document.getElementById('combinedActionsChart');
    const combinedActionsChart = new Chart(combActionsCtx, {
      type: 'bar',
      data: {
        labels: ['On track', 'At risk', 'Overdue'],
        datasets: [{
          label: 'Actions',
          data: [36, 12, 8],
          backgroundColor: [chartColors.green, chartColors.amber, chartColors.pink]
        }]
      },
      options: {
        responsive: true,
        maintainAspectRatio: false,
        plugins: { legend: { display: false } },
        scales: {
          x: { ticks: { color: chartColors.axis }, grid: { display:false } },
          y: { ticks: { color: chartColors.axis }, grid: { color:'rgba(55,65,81,0.45)' } }
        }
      }
    });

    const combRiskCtx = document.getElementById('combinedRiskChart');
    const combinedRiskChart = new Chart(combRiskCtx, {
      type: 'bar',
      data: {
        labels: ['Critical', 'High', 'Medium'],
        datasets: [{
          label: 'Risks',
          data: [3, 18, 23],
          backgroundColor: [chartColors.pink, chartColors.amber, chartColors.teal]
        }]
      },
      options: {
        responsive: true,
        maintainAspectRatio: false,
        plugins: { legend: { display: false } },
        scales: {
          x: { ticks: { color: chartColors.axis }, grid: { display:false } },
          y: { ticks: { color: chartColors.axis }, grid: { color:'rgba(55,65,81,0.45)' } }
        }
      }
    });
  </script>
</body>
</html>
